/*
=================================================
KitKatClock jQuery Plugin

Author: Bryan Iddings
http://iddings.co/KitKatClock

****MAINTAIN THIS HEADER WHEN REDISTRIBUTING****

This work is licensed under the Creative
Commons Attribution-NonCommercial-ShareAlike
4.0 International License. To view a copy of
this license, visit
http://creativecommons.org/licenses/by-nc-sa/4.0/
=================================================
*/
(function(a){function f(f,b){!0===b&&(b="true");!1===b&&(b="false");var e=null===b||void 0===b?a(".kitkat-clock").attr("data-"+f):a(".kitkat-clock").attr("data-"+f,b);if("true"==e||"false"==e)e="true"==e;return e}function k(d,b){if(null===b||void 0===b)b=300;if("minute"==d){a(".kitkat-clock-minutes").show();a(".kitkat-clock-hours").animate({top:"-10%",left:"-10%",width:"120%",height:"120%",opacity:0},b,"flex",function(){a(".kitkat-clock-hours").hide()});a(".kitkat-clock-minutes").css({top:"10%",left:"10%",
width:"80%",height:"80%",opacity:0});a(".kitkat-clock-minutes").animate({top:"0%",left:"0%",width:"100%",height:"100%",opacity:1},b,"flex");a(".kitkat-clock-minutes").show();f("hourmode",!1);a(".kitkat-hour").removeClass("kitkat-time-active");a(".kitkat-minute").addClass("kitkat-time-active");var e=parseInt(f("minutes"));isNaN(e)&&(e=0);setTimeout(function(){a(".kitkat-clock-hand").css({"-webkit-transform":"rotate("+6*e+"deg)"})},b/2)}else a(".kitkat-clock-hours").show(),a(".kitkat-clock-minutes").animate({top:"10%",
left:"10%",width:"80%",height:"80%",opacity:0},b,"flex",function(){a(".kitkat-clock-minutes").hide()}),a(".kitkat-clock-hours").css({top:"-10%",left:"-10%",width:"120%",height:"120%",opacity:0}),a(".kitkat-clock-hours").animate({top:"0%",left:"0%",width:"100%",height:"100%",opacity:1},b,"flex"),f("hourmode",!0),a(".kitkat-hour").addClass("kitkat-time-active"),a(".kitkat-minute").removeClass("kitkat-time-active"),e=parseInt(f("hours")),isNaN(e)&&(e=0),setTimeout(function(){a(".kitkat-clock-hand").css({"-webkit-transform":"rotate("+
30*e+"deg)"})},b/2)}a(function(){var d=a("<div class='kitkat-clock-element kitkat-container'><div class='kitkat-clock-element kitkat-time'><span class='kitkat-clock-element kitkat-hour'>12</span>:<span class='kitkat-clock-element kitkat-minute'>00</span><span class='kitkat-clock-element kitkat-am-pm'>AM</span></div><div class='kitkat-clock-element kitkat-clock'><div class='kitkat-clock-element kitkat-clock-body'></div><div class='kitkat-clock-element kitkat-clock-hand'><div class='kitkat-clock-element kitkat-clock-hand-line'></div><div class='kitkat-clock-element kitkat-clock-hand-end'></div></div><div class='kitkat-clock-element kitkat-clock-hours'></div><div class='kitkat-clock-element kitkat-clock-minutes'></div><div class='kitkat-clock-element kitkat-clock-cover'></div><div class='kitkat-clock-element kitkat-clock-am kitkat-clock-am-pm-active'><span class='kitkat-clock-element'>AM</span></div><div class='kitkat-clock-element kitkat-clock-pm'><span class='kitkat-clock-element'>PM</span></div></div><div class='kitkat-clock-element kitkat-done'>Done</div></div>");
a("body").append(d).on("click",function(c){a(c.target).hasClass("kitkat-clock-element")||"time"==a(c.target).attr("data-role")||(c=parseInt(f("minutes")),10>c&&(c="0"+c),a("input[data-kitkat-active=true]").val(f("hours")+":"+c+(f("is_am")?" AM":" PM")).attr("data-kitkat-active","false"),a(".kitkat-container").hide())});for(d=0;12>d;d++){var b=Math.PI/2+d*Math.PI/6,e=.5-.78*Math.cos(b)/2,b=.5-.78*Math.sin(b)/2,e=a("<div>").html(0!=d?d:12).css({position:"absolute",top:100*b+"%",left:100*e+"%"});a(".kitkat-clock-hours").append(e)}for(d=
0;12>d;d++)b=Math.PI/2+d*Math.PI/6,e=.5-.78*Math.cos(b)/2,b=.5-.78*Math.sin(b)/2,e=a("<div>").html(5*d).css({position:"absolute",top:100*b+"%",left:100*e+"%"}),a(".kitkat-clock-minutes").append(e);f("hourmode",!0);f("mousedown",!1);a(".kitkat-hour").addClass("kitkat-time-active").on("click",function(){f("hourmode")||k("hour")});a(".kitkat-minute").on("click",function(){f("hourmode")&&k("minute")});a(".kitkat-clock-hours").children().each(function(){a(this).css({marginTop:a(this).outerHeight()/-2,
marginLeft:a(this).outerWidth()/-2})});a(".kitkat-clock-minutes").children().each(function(){a(this).css({marginTop:a(this).outerHeight()/-2,marginLeft:a(this).outerWidth()/-2})});a(".kitkat-clock-am").on("click",function(){f("is_am",!0);a(".kitkat-clock-am").addClass("kitkat-clock-am-pm-active");a(".kitkat-clock-pm").removeClass("kitkat-clock-am-pm-active");a(".kitkat-am-pm").html("AM")});a(".kitkat-am-pm").on("click",function(){f("is_am")?(a(".kitkat-clock-am").removeClass("kitkat-clock-am-pm-active"),
a(".kitkat-clock-pm").addClass("kitkat-clock-am-pm-active"),a(".kitkat-am-pm").html("PM")):(a(".kitkat-clock-pm").removeClass("kitkat-clock-am-pm-active"),a(".kitkat-clock-am").addClass("kitkat-clock-am-pm-active"),a(".kitkat-am-pm").html("AM"));f("is_am",!f("is_am"))});a(".kitkat-clock-pm").on("click",function(){f("is_am",!1);a(".kitkat-clock-pm").addClass("kitkat-clock-am-pm-active");a(".kitkat-clock-am").removeClass("kitkat-clock-am-pm-active");a(".kitkat-am-pm").html("PM")});a(".kitkat-clock-minutes").hide();
a(".kitkat-done").on("click",function(){var c=parseInt(f("minutes"));10>c&&(c="0"+c);a("input[data-kitkat-active=true]").val(f("hours")+":"+c+(f("is_am")?" AM":" PM")).attr("data-kitkat-active","false");a(".kitkat-container").hide()});a(".kitkat-clock-cover").on("mousemove mousedown mouseup touchstart touchend touchcancel click touchmove",function(c){var b;if("touchmove"==c.type||"touchstart"==c.type)c.offsetX=c.originalEvent.touches[0].pageX,c.offsetY=c.originalEvent.touches[0].pageY,b=a(".kitkat-clock-body").offset(),
c.offsetX-=b.left,c.offsetY-=b.top;switch(c.type){case "touchmove":b="mousemove";c.preventDefault();break;case "touchend":b="mouseup";break;case "touchcancel":b="mouseup";break;case "touchstart":b="mousedown";break;default:b=c.type}var e=a(".kitkat-clock-body").outerWidth()/2;"mousedown"==b&&f("mousedown",!0);"mouseup"==b&&f("mousedown",!1);if("click"==b||"mousedown"==b||"mousemove"==b&&f("mousedown")){var d=f("hourmode")?12:60,g=c.offsetX-e;c=c.offsetY-e;d/=2;e=Math.sqrt(g*g+c*c);c=Math.asin(c/e);
c=Math.PI/d*Math.round(c/(Math.PI/d));c/=Math.PI;c*=d;d/=2;0<g||(d*=3,c*=-1);g=d+c;d=0+g*Math.PI/(f("hourmode")?6:30);d=d>2*Math.PI?d-2*Math.PI:d;a(".kitkat-clock-hand").css({"-webkit-transform":"rotate("+180/Math.PI*d+"deg)"});g=Math.round(g);f("hourmode")?(0==g&&(g=12),f("hours",g),a(".kitkat-hour").html(g),"mouseup"!=b&&"click"!=b||k("minute")):(60==g&&(g=0),f("minutes",g),10>g&&(g="0"+g),a(".kitkat-minute").html(g))}});a(".kitkat-container").hide();a.fn.kitkatclock.noDegrade(!0)});a.easing.flex=
function(a){return.5>a?-.125*Math.sin(a*Math.PI*2):2*a-1};a.fn.kitkatclock=function(){return this.each(function(){var d="12:00 AM";this.value.match(/\d{1,2}\:\d{2} AM|PM/i)&&(d=this.value);this.value=d;a(this).on("click focus",function(b){b.preventDefault();b="12:00 AM";this.value.match(/\d{1,2}\:\d{2} AM|PM/i)&&(b=this.value);this.value=b;b=b.split(":");f("hours",b[0]);f("is_am",-1!=b[1].toLowerCase().indexOf("am"));f("minutes",b[1].split(" ")[0]);a(".kitkat-hour").html(b[0]);a(".kitkat-minute").html(b[1].split(" ")[0]);
a(".kitkat-am-pm").html(b[1].split(" ")[1].toUpperCase());a("input[data-kitkat-active=true]").attr("data-kitkat-active","false");a(this).attr("data-kitkat-active","true");a(".kitkat-clock-am, .kitkat-clock-pm").removeClass("kitkat-clock-am-pm-active");a(".kitkat-clock-"+(f("is_am")?"am":"pm")).addClass("kitkat-clock-am-pm-active");k("hour",0);b=a(".kitkat-container");for(var e=a(this).offset(),c=a(window).width(),d=a(window).height(),p=a(document).width(),q=a(document).height(),g=b.outerWidth(),l=
b.outerHeight(),h=e.top,e=e.left,m=a("body").scrollTop(),n=a("body").scrollLeft(),r=m+d,s=n+c;h+l>q&&0<h;)h-=1;for(;e+g>p&&0<e;)e-=1;if(g<=c){for(;e<n;)e++;for(;e+g>s;)e--}else e=n-(g-c)/2;if(l<=d){for(;h<m;)h++;for(;h+l>r;)h--}else h=m-(l-d)/2;b.css({position:"absolute",top:h,left:e}).show()})})};a.fn.kitkatclock.noDegrade=function(d){d?(a("input[type=time]").attr({type:"text","data-role":"time"}),a("input[data-role=time]").kitkatclock()):a.fn.kitkatclock=function(){}}})(jQuery);
